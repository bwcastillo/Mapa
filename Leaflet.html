<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Mapa</title>
//ESTILOS
<link rel="stylesheet" href="estilos.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css"/>
  
//SCRIPTS LEAFLET
   	<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
   	<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
  integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
   crossorigin=""></script>
   
//SCRIPT GEOCSV
   	<script src="leaflet.geocsv.js"></script>
   	
//SCRIPT MARKER CLUSTER
   <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
   <script type="text/javascript" src="ciclovia.js"></script>
   <script type="text/javascript" src="barrios.js"></script>
 <script src="https://code.jquery.com/jquery-2.1.4.min.js">//JQUERY </script>

</head>
	
	
<body>
<header id= "cabecera" > <h1 >Mapa subdirección gestión ambiental</h1> </header>
<div id="mapid"></div>
<style>#mapid { height: 800px; }</style>


<script> //TILE MAP 

var mymap = L.map('mapid',{maxBounds:[
    [-33.427883, -70.935382],
    [-33.586710, -70.718632]
]}).setView([-33.5359312, -70.789277], 11);
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>, Autor: Bryan Castillo M.', minZoom:13 ,maxZoom: 17, id: 'mapbox.streets',accessToken: 'pk.eyJ1IjoiYndjYXN0aWxsbyIsImEiOiJjaXpxZ2s5ZTcwMWptMzJueWJ5dW03cWxwIn0.Sod29kk9UzEzM1ZGfRi1VQ'}).addTo(mymap);</script>

<script>//COMPONENTS
L.geoJson(barrios,{ onEachFeature: popup,weight: 2, opacity: 1, color: "#000000", dashArray: '3',fill: "false", fillOpacity: 0.1}).addTo(mymap);
L.geoJson(bicivias,{color:  '#FFFFFF',dashArray: '8',}).addTo(mymap);
var coolPlaces = new L.LayerGroup();
var overlays = {"Interesting places": coolPlaces};
L.control.layers(overlays).addTo(mymap);

</script>

<script>
	
	var SEIA = L.geoCsv('https://docs.google.com/spreadsheets/d/1xZ-GxcvD1AuhX4HNu-Fj4AZO20GKbr7_t720XQkKPDQ/edit#gid=1806900358', {firstLineTitles: true, fieldSeparator: ',',
	onEachFeature: function (feature, layer) {
		var popup = '';
		for (var clave in feature.properties) {
			var title = SEIA.getPropertyTitle(clave);
			popup += '<b>'+title+'</b><br />'+feature.properties[clave]+'<br /><br />';
		}
		layer.bindPopup(popup);
	},
	pointToLayer: function (feature, latlng) {
		return L.marker(latlng, {
			icon:L.icon({
				iconUrl: 'marcador-bankia.png',
				shadowUrl: 'marker-shadow.png',
				iconSize: [25,41],
				shadowSize:   [41, 41],
				shadowAnchor: [13, 20]
			})
		});
	},
	firstLineTitles: true
});
$.ajax ({
	type:'GET',
	dataType:'text',
	url:'https://docs.google.com/spreadsheets/d/1xZ-GxcvD1AuhX4HNu-Fj4AZO20GKbr7_t720XQkKPDQ/edit#gid=1806900358',
   error: function() {
     alert('No se pudieron cargar los datos');
   },
	
	success: function(csv) {
    SEIA.addData(csv);
    mymap.addLayer(SEIA);
  }
});
	</script>

<script src= "marcadores.js"> </script>


</body>
</html>
