<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Mapa</title>

<link rel="stylesheet" href="estilos.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css"/>
  

   	<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
   	<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
  integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
   crossorigin=""></script>
   

   	<script src="leaflet.geocsv.js"></script>
   	

   <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
   <script type="text/javascript" src="ciclovia.js"></script>
   <script type="text/javascript" src="barrios.js"></script>
 <script src="https://code.jquery.com/jquery-2.1.4.min.js">//JQUERY </script>
 <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>

<style>#mapid { height: 800px; }</style>
</head>
	
	
<body>
<header id= "cabecera" > <h1 >Mapa subdirección gestión ambiental</h1> </header>
<div id="mapid"></div>



<script> //TILE MAP 

var mymap = L.map('mapid',{maxBounds:[
    [-33.328620, -70.939942],
    [-33.619460, -70.700762]
]}).setView([-33.532898, -70.756266], 12); /*-33.5359312, -70.789277*/
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>, Autor: Bryan Castillo M.', minZoom:13 ,maxZoom: 17, id: 'mapbox.streets',accessToken: 'pk.eyJ1IjoiYndjYXN0aWxsbyIsImEiOiJjaXpxZ2s5ZTcwMWptMzJueWJ5dW03cWxwIn0.Sod29kk9UzEzM1ZGfRi1VQ'}).addTo(mymap);</script>

<script>//COMPONENTS
L.geoJson(barrios,{ onEachFeature: popup,weight: 2, opacity: 1, color: "#000000", dashArray: '3',fill: "false", fillOpacity: 0.1}).addTo(mymap);
	
var marcadores= "";
var grupo= new L.LayerGroup();
var flaco = new L.LayerGroup();
var eia= new L.LayerGroup();
var EEdPtoVer= new L.LayerGroup();
var BiblVerd= new L.LayerGroup();
var EcoSed= new L.LayerGroup();
var PtoLim= new L.LayerGroup();
var MinPtoVer= new L.LayerGroup();
var edAmOct= new L.LayerGroup();
var edAmSep= new L.LayerGroup();
var edAmAgo= new L.LayerGroup();
var edamjul= new L.LayerGroup();
var edamjun= new L.LayerGroup();
var edAmMay= new L.LayerGroup();
var edAmAbr= new L.LayerGroup();
var edAmMar= new L.LayerGroup();
var bicis= new L.LayerGroup();
var Campvid= new L.LayerGroup();
var coord1= " ";
var markers="";


var overlays =
{"Proyectos DIA": flaco,"Proyectos EIA": eia, "Ecobibliotecas": BiblVerd, "Sedes sustentables":EcoSed, "Puntos verdes": PtoLim, "Mini punto verde": MinPtoVer, "Educación ambiental marzo 2017": edAmMar, "Educación ambiental abril 2017": edAmAbr,"Educación ambiental mayo 2017":edAmMay, "Educación ambiental junio 2017":edamjun, "Educación ambiental julio 2017":edamjul, "Educación ambiental agosto 2017":edAmAgo, "Educación ambiental septiembre 2017":edAmSep, "Educación ambiental octubre 2017":edAmOct, "Ciclovias": bicis, "Campanas de vidrio (reciclaje)": Campvid,"plis":grupo};




var latitud= 'lat';
var longitud= 'lng';
var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1xZ-GxcvD1AuhX4HNu-Fj4AZO20GKbr7_t720XQkKPDQ/edit#gid=1806900358';


	
function showInfo(marcadores) {
                       for (num=0; num<marcadores.length; num++)
					   {current=marcadores[num];
					var lati= current[latitud];
					var longi= current[longitud];
						lati =lati.replace(",",".");
						longi =longi.replace(",",".");
					L.marker([longi, lati]).addTo(grupo)
					   }};
					
	
function setup()  {
  Tabletop.init( { key: publicSpreadsheetUrl,
                   callback: showInfo,
                   simpleSheet: true }
			  	)
};
	
	setup();
	
		
	
	
	
L.control.layers(overlays).addTo(mymap).setPosition('bottomleft').expand();
L.geoJson(bicivias,{color:  '#FFFFFF',dashArray: '8',}).addTo(bicis);

</script>


<script src="diaseia.js"></script>
<script src="eiaseia.js"></script>
<script src="puntolimpio.js"></script>
<script src="miniptoverd.js"></script>
<script src="estamb.js"></script>
<script src="edambsep.js"></script>
<script src="edamboct.js"></script>
<script src="edambmay.js"></script>
<script src="edambjun.js"></script>
<script src="edambjul.js"></script>
<script src="edambamar.js"></script>
<script src="edambago.js"></script>
<script src="edambabr.js"></script>
<script src="ecosede.js"></script>
<script src="biblioverde.js"></script>
<script src="campanavid.js"></script>
</body>
</html>
