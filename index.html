<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximumscale=1.0, user-scalable=no" />
<title>Mapa</title>

<link rel="stylesheet" href="estilos.css" />

<!-- Hoja de estilos Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>
 
<!--Librería JS Leaflet-->
<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
  integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
   crossorigin=""></script>
 
<!--Librería JQuery-->
 <script src="https://code.jquery.com/jquery-2.1.4.min.js">//JQUERY </script>
 
<!--Librería Popper.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

<!--Hoja de estilos Leaflet.Routing.machine -->
<link rel="stylesheet" href="dist/leaflet-routing-machine.css"/>

<!--Hoja de estilos y librería LeafletControlGeocoder -->
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!--Hoja de estilos y librería leafletAwesomeMarkers--> 
<link rel="stylesheet" href="dist/leaflet.awesome-markers.css"/>
<script src="dist/leaflet.awesome-markers.js"></script>

<!--Librería Tabletop-->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
 
<!--Objetos GeoJson -->
 <script type="text/javascript" src="ciclovia.js"></script>
 <script type="text/javascript" src="barrios.js"></script>
<style>body {
    padding: 0;
    margin: 0;
}
html, body, #mapid {
    height: 100%;
    width: 100vw;
}</style>

</head>


<body>

<header id= "cabecera" > <h1 >Mapa subdirección gestión ambiental</h1> </header>
<div id="mapid"></div>
<script src="dist/leaflet-routing-machine.js"></script>

<script> 
//Aquí se agrega el mapabase dentro de la variable "mymap", además se les proporcionan algunas características iniciales 
var mymap = L.map('mapid',{maxBounds:[
    [-33.328620, -70.939942],
    [-33.619460, -70.700762]
]}).setView([-33.532898, -70.756266], 12); /*-33.5359312, -70.789277*/
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>, Autor: Bryan Castillo M.', minZoom:10 ,maxZoom: 17, id: 'mapbox.streets',accessToken: 'pk.eyJ1IjoiYndjYXN0aWxsbyIsImEiOiJjaXpxZ2s5ZTcwMWptMzJueWJ5dW03cWxwIn0.Sod29kk9UzEzM1ZGfRi1VQ'}).addTo(mymap);
	
	
/*L.Routing.control({
	router: L.Routing.mapbox('pk.eyJ1IjoiYndjYXN0aWxsbyIsImEiOiJjaXpxZ2s5ZTcwMWptMzJueWJ5dW03cWxwIn0.Sod29kk9UzEzM1ZGfRi1VQ'), 
	geocoder: 
    }).addTo(mymap)*/
	
	
</script>

<script>
//Llamo al objeto geoJson base "Barrios" que está fijado en el mapa mymap
L.geoJson(barrios,{ onEachFeature: popup,weight: 2, opacity: 1, color: "#000000", dashArray: '3',fill: "false", fillOpacity: 0.1}).addTo(mymap);

//  Variables declaradas como LayerGroup, las que traen los objetos a ser cartografeados en leaflet luego de ser agrupados en el layer control declarado en la variable overlays

var grupo= new L.LayerGroup();
var flaco = new L.LayerGroup();
var eia= new L.LayerGroup();
var EEdPtoVer= new L.LayerGroup();
var BiblVerd= new L.LayerGroup();
var EcoSed= new L.LayerGroup();
var PtoLim= new L.LayerGroup();
var MinPtoVer= new L.LayerGroup();
var edAmOct= new L.LayerGroup();
var edAmSep= new L.LayerGroup();
var edAmAgo= new L.LayerGroup();
var edamjul= new L.LayerGroup();
var edamjun= new L.LayerGroup();
var edAmMay= new L.LayerGroup();
var edAmAbr= new L.LayerGroup();
var edAmMar= new L.LayerGroup();
var bicis= new L.LayerGroup();
var Campvid= new L.LayerGroup();
var rutaAgua= new L.LayerGroup();
var cerEstEdMun= new L.LayerGroup();
var cultivaTuSalud= new L.LayerGroup();

//Variable que agrupa los Layergroup que searán ejecutados en el Layer Control
var overlays =
{"Proyectos DIA": flaco,"Proyectos EIA": eia, "Ecobibliotecas": BiblVerd, "Sedes sustentables":EcoSed, "Puntos verdes": PtoLim, "Mini punto verde": MinPtoVer, "Educación ambiental marzo 2017": edAmMar, "Educación ambiental abril 2017": edAmAbr,"Educación ambiental mayo 2017":edAmMay, "Educación ambiental junio 2017":edamjun, "Educación ambiental julio 2017":edamjul, "Educación ambiental agosto 2017":edAmAgo, "Educación ambiental septiembre 2017":edAmSep, "Educación ambiental octubre 2017":edAmOct, "Ciclovias": bicis, "Campanas de vidrio (reciclaje)": Campvid,"Certificación Ambiental de establecimientos educacionales":cerEstEdMun, "Establecimiento educacional punto verde": EEdPtoVer, "Ruta del agua":rutaAgua, "Actividades Emblemáticas":grupo, "Programa Cultiva tu Salud":cultivaTuSalud};

//Variables globales que busca los atributos en google drive a través de Tabletop ( Por lo que me di cuenta en líneas y procesos posteriores, hice un montón de variables globales innecesarias para los bucle de las distintas funciones; las iteraciones de éstas últimas, quedan almacenadas en la variable o layer que forma un LayerGroup, sin influir al resto de ellas)

var a, b, c, d, e, f, g ,h,i,j,k,l,m,n,o,p,q,r;
var coorA, coorB, coorC, coorD, coorE, coorF, coorG, coorH, coorI, coorJ, coorK, coorL, coorM, coorN,coorO, coorP, coorQ, coorR;
var lat_a= 'lata';
var lat_b= 'latb';
var lat_c= 'latc';
var lat_d= 'latd';
var lat_e= 'late';
var lat_f= 'latf';
var lat_g= 'latg';
var lat_h= 'lath';
var lat_i= 'lati';
var lat_j= 'latj';
var lat_k= 'latk';
var lat_l= 'latl';
var lat_m= 'latm';
var lat_n= 'latn';
var lat_o= 'lato';
var lat_p= 'latp';
var lat_q= 'latq';
var lat_r= 'latr';
var lng_a= 'lnga';
var lng_b= 'lngb';
var lng_c= 'lngc';
var lng_d= 'lngd';
var lng_e= 'lnge';
var lng_f= 'lngf';
var lng_g= 'lngg';
var lng_h= 'lngh';
var lng_i= 'lngi';
var lng_j= 'lngj';
var lng_k= 'lngk';
var lng_l= 'lngl';
var lng_m= 'lngm';
var lng_n= 'lngn';
var lng_o= 'lngo';
var lng_p= 'lngp';
var lng_q= 'lngq';
var lng_r= 'lngr';
var latA,latB,latC,latD,latE,latF,latG,latH,latI,latJ,latK,latL,latM,latN,latO,latP,latQ,latR;
var lngA,lngB,lngC,latD,lngE,lngF,lngG,lngH,lngI,lngJ,lngK,lngL,lngM,lngN,latO,lngP,lngQ,lngR;

//var global reemplazo;
var reemp=" ";
//var global dirección
var adress= " ";
//var globales A 
var nomEstabl, lvlCert ;
//var globales B ,C,D,E,F,G,H,I,J,M
var progra, nomTall, lug, horari, encar, fechIni;
//var globales K
var nomProy, descProy;
//var gloables L
var nombBibl;
//var globales M
var tipoEnv;
//var globales N 
var status;
// var globales O,P
var queRecic;
// var gloables Q
var numPara;
// var globales R
var barrio;


	


// Variable que hace referencia a la tabla drive 
	
var publicSpreadsheetUrla = 'https://docs.google.com/spreadsheets/d/1dtaMxRz7RRBZU8nkaiBRSd-8kPShVRgVzEpYdA-vMGg/edit#gid=0';
var publicSpreadsheetUrlb= 'https://docs.google.com/spreadsheets/d/14B9n-n1y6knJtSEE0t6fGuH9nLr3lkfMaxUZ5Cq9yVQ/edit#gid=0';
var publicSpreadsheetUrlc= 'https://docs.google.com/spreadsheets/d/1v1daCCv9QxPWye6-QErr5H4O_Kz0YPXslXOGPoQtSBY/edit#gid=0';
var publicSpreadsheetUrld= 'https://docs.google.com/spreadsheets/d/1Heeoa59TXr2OONcoAvguf7MMlrXlCdWZ4bhMq9AseLc/edit#gid=0';
var publicSpreadsheetUrle= 'https://docs.google.com/spreadsheets/d/1WyS-EJGPwjXZhjfj5on-WRA1urZ0YPsiWWKoJnYw2N4/edit#gid=0';
var publicSpreadsheetUrlf= 'https://docs.google.com/spreadsheets/d/178-cBz50rzFdcgCzKvGVrhyh1ydP2Q84-jRqhGJ4qXc/edit#gid=0';
var publicSpreadsheetUrlg= 'https://docs.google.com/spreadsheets/d/11ahA4OesCGyMPQ_zqTqndmaszl594hUgE6TRmw-JY04/edit#gid=0';
var publicSpreadsheetUrlh= 'https://docs.google.com/spreadsheets/d/1AR4hu51fGBzdnLp-a9ltV1G3CVfyX-11qPaqzBFhZ5Y/edit#gid=0';
var publicSpreadsheetUrli= 'https://docs.google.com/spreadsheets/d/1W0z-spcigoni0bAwwK--AzE1O1nvbo1ZC2GhbOzcWGo/edit#gid=0';
var publicSpreadsheetUrlj= 'https://docs.google.com/spreadsheets/d/1XKCCnTe7d2QlXSP39ncRk9wAqH6p6J1MjZYFESHP2eI/edit#gid=0';
var publicSpreadsheetUrlk= 'https://docs.google.com/spreadsheets/d/1lu94QuJEVJS7LwchzEYOrk0O_8YAKLYxNsHa6Ynyc8I/edit#gid=0';
var publicSpreadsheetUrll= 'https://docs.google.com/spreadsheets/d/1ew-yWgHwi5Abt6b8FVOY3ATX9wcBuX1h91-KByxzAS8/edit#gid=0';
var publicSpreadsheetUrlm= 'https://docs.google.com/spreadsheets/d/1tyz6zddhGx5pMV0r0iMZsj96wgiZlWfuT-SXXyeEXs4/edit#gid=0';
var publicSpreadsheetUrln= 'https://docs.google.com/spreadsheets/d/1IGDIjtu1r5OP2-geCUrkMaA0v_ZSfiuh8N1pqNM-Qk4/edit#gid=0'
var publicSpreadsheetUrlo= 'https://docs.google.com/spreadsheets/d/1zQ0gcK7DbVuuWLymP6XuxETLxsCdeOExVxBoaKnHkYQ/edit#gid=0'
var publicSpreadsheetUrlp='https://docs.google.com/spreadsheets/d/1xnSKjRbpEF9mMKkG72bsH5sf-er6QOlPSZsWOgJmB34/edit#gid=0'
var publicSpreadsheetUrlq='https://docs.google.com/spreadsheets/d/1En4PupkUwo2HUOyV5sQ_U2pcnSi6p1ePcZJXornhZVY/edit#gid=0'
var publicSpreadsheetUrlr='https://docs.google.com/spreadsheets/d/1a314Q1QbaVDuF1NVjz_mhtQmehDypNDYXxM7-E0b_bM/edit#gid=0'
	

// Iteración busca datos en el google drive a través de Tabletop

// A: Certificación ambiental de establecimientos educacionales en 2017

function showInfoa(marcadoresa) {
                       for (num=0; num<marcadoresa.length; num++)
					   {current=marcadoresa[num];
					var latA= current[lat_a];
					var lngA= current[lng_a];
						latA =latA.replace(",",".");
						lngA =lngA.replace(",",".");
						coorA= [lngA, latA];
						
		//Iteración de los atributos extraídos:
						
						nomEstabl=current['Nombre del Establecimiento']
						;
						lvlCert=current['Nivel de Certificación obtenido'];
						adress=current['direccion'];
						
						L.marker(coorA,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(cerEstEdMun).bindPopup("<b>Nombre del Establecimiento:</b><br>"+nomEstabl+"<br><br><b> Nivel de certificado obtenido:</b><br>"+lvlCert+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}
	// B: Educación ambiental marzo 2017
function showInfob(marcadoresb) {
                       for (num=0; num<marcadoresb.length; num++)
					   {current=marcadoresb[num];
					var latB= current[lat_b];
					var lngB= current[lng_b];
						latB =latB.replace(",",".");
						lngB =lngB.replace(",",".");
						coorB= [lngB, latB];
		
		//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						L.marker(coorB,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edAmMar).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
					   }
				   ;}
// C: Educación ambiental abril 2017
function showInfoc(marcadoresc) {
                       for (num=0; num<marcadoresc.length; num++)
					   {current=marcadoresc[num];
					var latC= current[lat_c];
					var lngC= current[lng_c];
						latC =latC.replace(",",".");
						lngC =lngC.replace(",",".");
						coorC= [lngC, latC];
							//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorC,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edAmAbr).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}
// D: Educación ambiental mayo 2017
function showInfod(marcadoresd) {
                       for (num=0; num<marcadoresd.length; num++)
					   {current=marcadoresd[num];
					var latD= current[lat_d];
					var lngD= current[lng_d];
						latD =latD.replace(",",".");
						lngD =lngD.replace(",",".");
						coorD= [lngD, latD];
						
						//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorD,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edAmMay).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
					   }
				   ;}
	
// E: Educación ambiental junio 2017
function showInfoe(marcadorese) {
                       for (num=0; num<marcadorese.length; num++)
					   {current=marcadorese[num];
					var latE= current[lat_e];
					var lngE= current[lng_e];
						latE =latE.replace(",",".");
						lngE =lngE.replace(",",".");
						coorE= [lngE, latE];
						
						//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorE,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edamjun).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}

// F: Educación ambiental julio 2017
function showInfof(marcadoresf) {
                       for (num=0; num<marcadoresf.length; num++)
					   {current=marcadoresf[num];
					var latF= current[lat_f];
					var lngF= current[lng_f];
						latF =latF.replace(",",".");
						lngF =lngF.replace(",",".");
						coorF= [lngF, latF];
						
						//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorF,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edamjul).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}

// G: Educación ambiental agosto 2017
function showInfog(marcadoresg) {
                       for (num=0; num<marcadoresg.length; num++)
					   {current=marcadoresg[num];
					var latG= current[lat_g];
					var lngG= current[lng_g];
						latG =latG.replace(",",".");
						lngG =lngG.replace(",",".");
						coorG= [lngG, latG];
						
		//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorG,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edAmAgo).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}
	
// H: Educación ambiental septiembre 2017
function showInfoh(marcadoresh) {
                       for (num=0; num<marcadoresh.length; num++)
					   {current=marcadoresh[num];
					var latH= current[lat_h];
					var lngH= current[lng_h];
						latH =latH.replace(",",".");
						lngH =lngH.replace(",",".");
						coorH= [lngH, latH];
						
						//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorH,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edAmSep).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}
	
// I: Educación ambiental octubre 2017
function showInfoi(marcadoresi) {
                       for (num=0; num<marcadoresi.length; num++)
					   {current=marcadoresi[num];
					var latI= current[lat_i];
					var lngI= current[lng_i];
						latI =latI.replace(",",".");
						lngI =lngI.replace(",",".");
						coorI= [lngI, latI];
						
					
						//Iteración de los atributos extraídos:
						progra= current['PROGRAMA'];
						nomTall= current['NOMBRE TALLER'];
						lug= current['LUGAR'];
						horari= current['DÍA - HORA'];
						encar= current['ENCARGADO'];
						adress = current ['direccion'];
						
						
			L.marker(coorI,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(edAmOct).bindPopup("<b>Programa:</b><br>"+progra+"<br><br> <b> Nombre del taller</b><br>"+nomTall+"<br><br><b>Lugar</b><br>"+lug+"<br><br><b>Horarios</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}

// J: PROGRAMA CULTIVA TU SALUD
function showInfoj(marcadoresj) { 
                       for (num=0; num<marcadoresj.length; num++)
					   {current=marcadoresj[num];
					var latJ= current[lat_j];
					var lngJ= current[lng_j];
						latJ =latJ.replace(",",".");
						lngJ =lngJ.replace(",",".");
						coorJ= [lngJ, latJ];
			
						
						//Iteración de los atributos extraídos:
						lug= current['LUGAR'];
						adress = current ['direccion'];
							
						L.marker(coorJ,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(cultivaTuSalud).bindPopup("<b>Lugar donde se ejecuta el programa:</b><br>"+lug+"<br><br><b>Dirección:</b><br>"+adress)
						
					   }
				   ;}
// K: Proyectos emblemáticos
function showInfok(marcadoresk) { 
                       for (num=0; num<marcadoresk.length; num++)
					   {current=marcadoresk[num];
					var latK= current[lat_k];
					var lngK= current[lng_k];
						latK =latK.replace(",",".");
						lngK =lngK.replace(",",".");
						coorK= [lngK, latK];
					
						//Iteración de los atributos extraídos:
						nomProy= current['Nombre del proyecto']
						descProy= current ['Descripción del proyecto']
						adress=current['direccion']
						
						L.marker(coorK,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(grupo).bindPopup("<b>Nombre del proyecto:</b><br>"+nomProy+"<br><br><b>Descripción del proyecto:</b><br>"+descProy+"<br><br><b>Dirección:<br></b>"+adress )
						
					   }
				   ;}
	
// L: Bibliotecas
function showInfol(marcadoresl) { 
                       for (num=0; num<marcadoresl.length; num++)
					   {current=marcadoresl[num];
					var latL= current[lat_l];
					var lngL= current[lng_l];
						latL =latL.replace(",",".");
						lngL =lngL.replace(",",".");
						coorL= [lngL, latL];
						
						//Iteración de los atributos extraídos:
						nombBibl= current['Nombre']
						horari= current ['Horarios']
						adress=current['direccion']
					
						L.marker(coorL,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(BiblVerd).bindPopup("<b>Nombre biblioteca:</b><br>"+nombBibl+"<br><br><b>Horario</b><br>"+horari+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}
function showInfom(marcadoresm) { 
                       for (num=0; num<marcadoresm.length; num++)
					   {current=marcadoresm[num];
					var latM= current[lat_m];
					var lngM= current[lng_m];
						latM =latM.replace(",",".");
						lngM =lngM.replace(",",".");
						coorM= [lngM, latM];
				//Iteración de los atributos extraídos:
						
						lug=current['Ubicación campanas'];
						tipoEnv=current['Tipos de envases'];
						adress=current['direccion']
						
						L.marker(coorM,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(Campvid).bindPopup("<b>Nombre de la ubicación:</b><br>"+lug+"<br><br><b>Envase de vidrios permitidos:</b><br>"+tipoEnv+"<br><br><b>Dirección</b><br>"+adress)
						
					   }
				   ;}
function showInfon(marcadoresn) { 
                       for (num=0; num<marcadoresn.length; num++)
					   {current=marcadoresn[num];
					var latN= current[lat_n];
					var lngN= current[lng_n];
					latN =latN.replace(",",".");
						lngN =lngN.replace(",",".");
						coorN= [lngN, latN];
				//Iteración de los atributos extraídos:
						
						nomEstabl=current['Establecimiento'];
						status=current['Estado'];
						adress=current['direccion'];
						
						
						L.marker(coorN,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(EEdPtoVer).bindPopup("<b>Nombre del establecimiento:</b><br>"+nomEstabl+"<br><br><b>Estado del punto limpio:</b><br>"+status+"<br><br><b>Dirección:</b><br>"+adress)
						
					   }
				   ;}  
function showInfoo(marcadoreso) { 
                       for (num=0; num<marcadoreso.length; num++)
					   {current=marcadoreso[num];
					var latO= current[lat_o];
					var lngO= current[lng_o];
				//	latN =latN.replace(",",".");
				//	lngN =lngN.replace(",",".");
						coorO= [lngO, latO];
				//Iteración de los atributos extraídos:
					lug=current['Lugar'];
					queRecic=current['Material Reciclaje'];
					adress=current['direccion'];
					horari=current['Horario de atención'];
					encar=current['Contacto'];
					
				
						L.marker(coorO,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(MinPtoVer).bindPopup("<b>Nombre de la ubicación:</b><br>"+lug+"<br><br><b>Que reciclar:</b><br>"+queRecic+"<br><br><b>Horario de atención</b><br>"+horari+"<br><br><b>Encargado</b><br>"+encar+"<br><br><b>Dirección:</b><br>"+adress)
						
					   }
				   ;}  
function showInfop(marcadoresp) { 
                       for (num=0; num<marcadoresp.length; num++)
					   {current=marcadoresp[num];
					var latP= current[lat_p];
					var lngP= current[lng_p];
				latP =latP.replace(",",".");
				lngP =lngP.replace(",",".");
						coorP= [lngP, latP];
							//Iteración de los atributos extraídos:
					lug=current['Nombre'];
					queRecic=current['Que reciclar'];
					adress=current['direccion'];
					
					L.marker(coorP,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(PtoLim).bindPopup("<b>Nombre de la ubicación:</b><br>"+lug+"<br><br><b>Que reciclar:</b><br>"+queRecic+"<br><br><b>Dirección:</b><br>"+adress)
						
					   }
				   ;}  
function showInfoq(marcadoresq) { 
                       for (num=0; num<marcadoresq.length; num++)
					   {current=marcadoresq[num];
					var latQ= current[lat_q];
					var lngQ= current[lng_q];
						latQ =latQ.replace(",",".");
						lngQ =lngQ.replace(",",".");
						coorQ= [lngQ, latQ];
						//Número de parada:
						numPara=current['N° de parada'];
						lug=current['Nombre parada'];
						adress=current['direccion'];
						
						L.marker(coorQ,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(rutaAgua).bindPopup("<b>Número de parada:</b><br>"+numPara+"<br><br><b>Nombre de la parada:</b><br>"+lug+"<br><br><b>Dirección:</b><br>"+adress)
						
					   }
				   ;}  
function showInfor(marcadoresr) { 
                       for (num=0; num<marcadoresr.length; num++)
					   {current=marcadoresr[num];
					var latR= current[lat_r];
					var lngR= current[lng_r];
						latR =latR.replace(",",".");
						lngR =lngR.replace(",",".");
						coorR= [lngR, latR];
						//Número de parada:
						lug=current['Nombre'];
						status=current['Estado'];
					barrio=current['Barrio'];	adress=current['direccion'];
						L.marker(coorR,{icon: L.AwesomeMarkers.icon({
      icon: 'bell', 
      prefix: 'glyphicon', markerColor:'red'})}).addTo(EcoSed).bindPopup("<b>Nombre de la sede:</b><br>"+lug+"<br><br><b>Vigencia:</b><br>"+status+"<br><br><b>Barrio:</b><br>"+barrio+"<br><br><b>Dirección:</b><br>"+adress)
						
					   }
				   ;}  

					
// Función que ejecuta la iteración anterior dentro de la función "showInfo" a través del callback 
function setup()  {
a = Tabletop.init( { key: publicSpreadsheetUrla,
                   callback: showInfoa,
                   simpleSheet: true }
			  	)
b = Tabletop.init( { key: publicSpreadsheetUrlb,
                   callback: showInfob,
                   simpleSheet: true }
			  	)
c = Tabletop.init( { key: publicSpreadsheetUrlc,
                   callback: showInfoc,
                   simpleSheet: true }
			  	) 
d = Tabletop.init( { key: publicSpreadsheetUrld,
                   callback: showInfod,
                   simpleSheet: true }
			  	)
e = Tabletop.init( { key: publicSpreadsheetUrle,
                   callback: showInfoe,
                   simpleSheet: true }
			  	)
f = Tabletop.init( { key: publicSpreadsheetUrlf,
                   callback: showInfof,
                   simpleSheet: true }
			  	)
g = Tabletop.init( { key: publicSpreadsheetUrlg,
                   callback: showInfog,
                   simpleSheet: true }
			  	)
h = Tabletop.init( { key: publicSpreadsheetUrlh,
                   callback: showInfoh,
                   simpleSheet: true }
			  	)
i = Tabletop.init( { key: publicSpreadsheetUrli,
                   callback: showInfoi,
                   simpleSheet: true }
			  	)
j = Tabletop.init( { key: publicSpreadsheetUrlj,
                   callback: showInfoj,
                   simpleSheet: true }
			  	)
k = Tabletop.init( { key: publicSpreadsheetUrlk,
                   callback: showInfok,
                   simpleSheet: true }
			  	)
l = Tabletop.init( { key: publicSpreadsheetUrll,
                   callback: showInfol,
                   simpleSheet: true }
			  	)
m = Tabletop.init( { key: publicSpreadsheetUrlm,
                   callback: showInfom,
                   simpleSheet: true }
			  	)
n = Tabletop.init( { key: publicSpreadsheetUrln,
                   callback: showInfon,
                   simpleSheet: true }
			  	) 
o = Tabletop.init( { key: publicSpreadsheetUrlo,
                   callback: showInfoo,
                   simpleSheet: true }
			  	) 

p = Tabletop.init( { key: publicSpreadsheetUrlp,
                   callback: showInfop,
                   simpleSheet: true }
			  	) 
q = Tabletop.init( { key: publicSpreadsheetUrlq,
                   callback: showInfoq,
                   simpleSheet: true }
			  	) 
r = Tabletop.init( { key: publicSpreadsheetUrlr,
                   callback: showInfor,
                   simpleSheet: true }
			  	) 
};

// Llamo a la función "setup" de Tabletop que es la que contiene las funciones y parámetros para ejecutar la hoja drive a Leaflet
setup();
	
//LLamo a la función control.layer 
L.control.layers(overlays).addTo(mymap).setPosition('bottomleft').expand();
	
//Llamo al objeto GeoJson de ciclovías
L.geoJson(bicivias,{color:  '#FFFFFF',dashArray: '8',}).addTo(bicis);
</script>


<!-- A continuación se llaman los objetos JS que fueron nombrados anteriormente -->
<script src="diaseia.js"></script>
<script src="eiaseia.js"></script>

</body>
</html>
